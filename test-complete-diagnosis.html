<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Diagn√≥stico Completo: Forgot Password</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-frame {
            width: 100%;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
        }
        .test-link {
            display: inline-block;
            padding: 10px 20px;
            background: #ec4913;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 10px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        .code { background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>üîç Diagn√≥stico Completo: Forgot Password</h1>
    
    <div class="test-section">
        <h2>1. Verificaci√≥n de Conectividad del Servidor</h2>
        <div id="server-status">Verificando servidor...</div>
    </div>

    <div class="test-section">
        <h2>2. Test de Rutas Directas</h2>
        <p>Probando cada ruta individualmente:</p>
        
        <a href="http://localhost:3001/" class="test-link" target="_blank">
            üè† Root (/)
        </a>
        
        <a href="http://localhost:3001/login" class="test-link" target="_blank">
            üìù Login (/login)
        </a>
        
        <a href="http://localhost:3001/forgot-password" class="test-link" target="_blank">
            üîê Forgot Password (/forgot-password)
        </a>
        
        <a href="http://localhost:3001/register" class="test-link" target="_blank">
            üë§ Register (/register)
        </a>
        
        <div id="route-status">Verificando rutas...</div>
    </div>

    <div class="test-section">
        <h2>3. Test de Login Page en Iframe</h2>
        <p>Cargando la p√°gina de login para ver si se renderiza:</p>
        <iframe src="http://localhost:3001/login" class="test-frame" id="login-frame"></iframe>
        <div id="login-status">Cargando...</div>
    </div>

    <div class="test-section">
        <h2>4. Test de Forgot Password en Iframe</h2>
        <p>Cargando la p√°gina de forgot-password directamente:</p>
        <iframe src="http://localhost:3001/forgot-password" class="test-frame" id="forgot-frame"></iframe>
        <div id="forgot-status">Cargando...</div>
    </div>

    <div class="test-section">
        <h2>5. An√°lisis de Errores</h2>
        <div class="info">
            <strong>Instrucciones:</strong>
            <ol>
                <li>Abre F12 ‚Üí Console en esta p√°gina</li>
                <li>Observa los mensajes de error en la consola</li>
                <li>Verifica si los iframes cargan correctamente</li>
                <li>Prueba los enlaces directos arriba</li>
            </ol>
        </div>
        <div id="error-analysis"></div>
    </div>

    <div class="test-section">
        <h2>6. Posibles Problemas Identificados</h2>
        <div class="warning">
            <strong>Si los iframes no cargan o muestran errores:</strong>
            <ul>
                <li>üîß <strong>Error de compilaci√≥n:</strong> TypeScript o React tiene errores</li>
                <li>üîÑ <strong>Problema de rutas:</strong> React Router no est√° configurado correctamente</li>
                <li>üì¶ <strong>Dependencias faltantes:</strong> Alg√∫n m√≥dulo no se puede importar</li>
                <li>üî• <strong>Firebase config:</strong> Problema con la configuraci√≥n de Firebase</li>
                <li>üöÄ <strong>Servidor:</strong> Vite no est√° sirviendo los archivos correctamente</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>7. Comandos de Diagn√≥stico</h2>
        <div class="code">
            <strong>Ejecuta estos comandos en la terminal del proyecto:</strong><br><br>
            # Verificar errores de compilaci√≥n<br>
            npm run build<br><br>
            # Verificar dependencias<br>
            npm ls<br><br>
            # Limpiar cache y reinstalar<br>
            rm -rf node_modules package-lock.json<br>
            npm install<br><br>
            # Reiniciar servidor<br>
            npm start
        </div>
    </div>

    <script>
        // Verificar servidor
        const checkServer = async () => {
            const serverStatusDiv = document.getElementById('server-status');
            try {
                const response = await fetch('http://localhost:3001/');
                if (response.ok) {
                    serverStatusDiv.innerHTML = '<div class="success">‚úÖ Servidor respondiendo correctamente en puerto 3001</div>';
                } else {
                    serverStatusDiv.innerHTML = `<div class="error">‚ùå Servidor responde con error: ${response.status} ${response.statusText}</div>`;
                }
            } catch (error) {
                serverStatusDiv.innerHTML = `<div class="error">‚ùå No se puede conectar al servidor: ${error.message}</div>`;
            }
        };

        // Verificar rutas
        const checkRoutes = async () => {
            const routeStatusDiv = document.getElementById('route-status');
            const routes = [
                ['/', 'Root'],
                ['/login', 'Login'],
                ['/forgot-password', 'Forgot Password'],
                ['/register', 'Register']
            ];

            let results = '';
            for (const [route, name] of routes) {
                try {
                    const response = await fetch(`http://localhost:3001${route}`);
                    const status = response.ok ? 'success' : 'error';
                    const icon = response.ok ? '‚úÖ' : '‚ùå';
                    results += `<div class="${status}">${icon} ${name} (${route}): ${response.status} ${response.statusText}</div>`;
                } catch (error) {
                    results += `<div class="error">‚ùå ${name} (${route}): Error - ${error.message}</div>`;
                }
            }
            routeStatusDiv.innerHTML = results;
        };

        // Monitorear iframes
        const loginFrame = document.getElementById('login-frame');
        const forgotFrame = document.getElementById('forgot-frame');
        const loginStatusDiv = document.getElementById('login-status');
        const forgotStatusDiv = document.getElementById('forgot-status');

        loginFrame.onload = function() {
            loginStatusDiv.innerHTML = '<div class="success">‚úÖ Login page cargada correctamente</div>';
            console.log('‚úÖ Login iframe cargado');
        };

        loginFrame.onerror = function() {
            loginStatusDiv.innerHTML = '<div class="error">‚ùå Error al cargar login page</div>';
            console.error('‚ùå Error en login iframe');
        };

        forgotFrame.onload = function() {
            forgotStatusDiv.innerHTML = '<div class="success">‚úÖ Forgot Password page cargada correctamente</div>';
            console.log('‚úÖ Forgot Password iframe cargado');
        };

        forgotFrame.onerror = function() {
            forgotStatusDiv.innerHTML = '<div class="error">‚ùå Error al cargar forgot password page</div>';
            console.error('‚ùå Error en forgot password iframe');
        };

        // Timeout para iframes
        setTimeout(() => {
            if (loginStatusDiv.innerHTML === 'Cargando...') {
                loginStatusDiv.innerHTML = '<div class="warning">‚ö†Ô∏è Login page tardando mucho en cargar</div>';
            }
            if (forgotStatusDiv.innerHTML === 'Cargando...') {
                forgotStatusDiv.innerHTML = '<div class="warning">‚ö†Ô∏è Forgot Password page tardando mucho en cargar</div>';
            }
        }, 10000);

        // Ejecutar verificaciones
        checkServer();
        checkRoutes();

        // Logs para debug
        console.log('üîç Diagn√≥stico completo iniciado');
        console.log('üìã Verificando:');
        console.log('   ‚Ä¢ Conectividad del servidor');
        console.log('   ‚Ä¢ Respuesta de rutas individuales');
        console.log('   ‚Ä¢ Carga de componentes en iframes');
        console.log('   ‚Ä¢ Errores de JavaScript');
        
        // Capturar errores globales
        window.addEventListener('error', function(e) {
            console.error('‚ùå Error global capturado:', e.error);
            const errorDiv = document.getElementById('error-analysis');
            errorDiv.innerHTML += `<div class="error">‚ùå Error JavaScript: ${e.message}</div>`;
        });

        // Capturar errores de promesas
        window.addEventListener('unhandledrejection', function(e) {
            console.error('‚ùå Promise rejection capturada:', e.reason);
            const errorDiv = document.getElementById('error-analysis');
            errorDiv.innerHTML += `<div class="error">‚ùå Promise Error: ${e.reason}</div>`;
        });
    </script>
</body>
</html>